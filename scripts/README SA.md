# README SA

## 需要的数据

1. 原始文本
2. 插入文本
3. 结果文本

用｜进行分隔

### 流程

### 1. 实体识别

#### 1.1. 生成结果存放结果的Excel表格

[run_deberta_SA.py](./run/run_deberta_SA.py)

[run_t5_SA.py](./run/run_t5_SA.py)

输入：需要的数据，即生成的SA相关的输入文件。

输出：Excel，包括原始文本、插入文本、结果文本的情感标签、积极概率、消极概率。

逻辑：调用模型接口后生成数据，然后保存。

> 需要额外添加最后一行index在最后一列（我当时已经运行完了，所以手动添加了）

#### 1.2. 判断命名实体的偏见

[SA_entity.py](./entity/SA_entity.py)

输入：1.1.部分生成的文件

输出：首先使用最终结果包含所有有问题的结果，每一行包含各类命名实体的文本和数量。

逻辑：如果插入语中被判断为积极，插入之后的结果消极的可能性却上升了（超过0.1）就认为有问题。

### 2. 词义理解

#### 2.1. 生成结果存放结果的Excel表格

[run_deberta_SA.py](./run/run_deberta_SA.py)

[run_t5_SA.py](./run/run_t5_SA.py)

输入：需要的数据，即生成的SA相关的输入文件。

输出：Excel，包括原始文本、插入文本、结果文本的情感标签、积极概率、消极概率。

逻辑：调用模型接口后生成数据，然后保存。

> 需要额外添加最后一行index在最后一列（我当时已经运行完了，所以手动添加了）

#### 2.2. 判断词义理解

[SA_meaning.py](./meaning/SA_meaning.py)

输入：1.1. 部分生成的文件

输出：先使用SA_meaning.py进行判断词义理解的问题。

逻辑：具有相同original_text但不同插入语的数据放在一组中，在一组中进行两两比较，如果取出来的一对数据之间的概率相差超过0.1，那么就将它们放在结果文件中。或者插入语积极，但消极概率上升超过0.1也判断为有问题。

> 需要手动按index进行排序。

#### 2.3. 后处理

[deal_SA_xlsx.py](./meaning/deal_SA_xlsx.py)

输入：2.2.部分生成的文件

输出：最终数据，使用deal_SA_xlsx进行分组，以及数据的切分。